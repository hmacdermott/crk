<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Run Kingdom Reference Guide</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-navy: #1a2332;
            --color-slate: #475569;
            --color-sage: #6b7c6e;
            --color-cream: #faf8f5;
            --color-amber: #d4a574;
            --color-warning: #c05621;
            --color-border: #e0ddd8;
            --color-success: #10b981;
            --font-serif: 'Crimson Pro', serif;
            --font-sans: 'DM Sans', sans-serif;
        }

        [data-theme="dark"] {
            --color-navy: #e8e6e3;
            --color-slate: #a8a29e;
            --color-sage: #a8b4a9;
            --color-cream: #1a1917;
            --color-amber: #d4a574;
            --color-warning: #f59e0b;
            --color-border: #3a3734;
            --color-success: #10b981;
        }

        [data-theme="dark"] body {
            background: linear-gradient(135deg, #1a1917 0%, #252320 100%);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-sans);
            background: linear-gradient(135deg, var(--color-cream) 0%, #ffffff 100%);
            color: var(--color-navy);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-top: 3rem;
        }

        h1 {
            font-family: var(--font-serif);
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--color-navy);
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--color-slate);
            font-weight: 400;
        }

        /* Utility Buttons */
        .utility-buttons {
            position: fixed;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            z-index: 1000;
        }

        .utility-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--color-amber);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .utility-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        [data-theme="dark"] .utility-btn {
            background: #475569;
        }

        [data-theme="dark"] .utility-btn:hover {
            background: #64748b;
        }

        /* Filters Section */
        .filters {
            background: white;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] .filters {
            background: #252320;
        }

        .filter-group {
            margin-bottom: 1.5rem;
        }

        .filter-group:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: block;
            color: var(--color-navy);
        }

        .search-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--color-border);
            font-size: 1rem;
            font-family: var(--font-sans);
            transition: border-color 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--color-amber);
        }

        [data-theme="dark"] .search-input {
            background: #1a1917;
            color: var(--color-navy);
            border-color: var(--color-border);
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .filter-chip {
            padding: 0.5rem 1rem;
            border: 2px solid var(--color-border);
            background: transparent;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            color: var(--color-slate);
        }

        .filter-chip:hover {
            border-color: var(--color-amber);
            color: var(--color-navy);
        }

        .filter-chip.active {
            background: var(--color-amber);
            border-color: var(--color-amber);
            color: white;
        }

        [data-theme="dark"] .filter-chip.active {
            background: #475569;
            border-color: #475569;
            color: white;
        }

        [data-theme="dark"] .filter-chip:hover {
            border-color: #64748b;
            color: var(--color-navy);
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        /* Cookie Grid */
        .cookie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .cookie-card {
            background: white;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.2s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .cookie-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .cookie-card.owned {
            border-color: var(--color-success);
        }

        [data-theme="dark"] .cookie-card {
            background: #252320;
        }

        .cookie-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            gap: 1rem;
        }

        .cookie-image-container {
            width: 100px;
            height: 100px;
            flex-shrink: 0;
            background: var(--color-cream);
            border: 2px solid var(--color-border);
        }

        .cookie-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .cookie-image-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-serif);
            font-weight: 700;
            font-size: 1.8rem;
            color: white;
            background: linear-gradient(135deg, var(--color-amber) 0%, var(--color-sage) 100%);
        }

        .cookie-info {
            flex: 1;
        }

        .cookie-rarity-row {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 0.25rem;
        }

        .cookie-icons {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .type-icon,
        .position-icon {
            width: 24px;
            height: 24px;
            object-fit: contain;
            background: white;
            border: 1px solid var(--color-border);
        }

        [data-theme="dark"] .type-icon,
        [data-theme="dark"] .position-icon {
            background: #1a1917;
        }

        .cookie-name {
            font-family: var(--font-serif);
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--color-navy);
            margin-bottom: 0.25rem;
        }

        .cookie-rarity {
            font-size: 0.8rem;
            color: var(--color-slate);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .owned-checkbox {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: var(--color-success);
        }

        .cookie-meta {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .badge-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .badge-group-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--color-slate);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 60px;
        }

        .meta-badge {
            padding: 0.25rem 0.75rem;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .type-position-badge {
            background: #e0f2fe;
            color: #0369a1;
            border: 1px solid #7dd3fc;
        }

        [data-theme="dark"] .type-position-badge {
            background: #0c4a6e;
            color: #7dd3fc;
            border-color: #0c4a6e;
        }

        .element-badge {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fcd34d;
        }

        [data-theme="dark"] .element-badge {
            background: #78350f;
            color: #fde68a;
            border-color: #78350f;
        }

        .cookie-stats {
            margin-bottom: 1rem;
        }

        .stats-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-slate);
            margin-bottom: 0.25rem;
        }

        .stats-value {
            font-size: 0.9rem;
            color: var(--color-navy);
        }

        .topping-recommendation {
            padding: 0.75rem;
            background: var(--color-cream);
            border-left: 4px solid var(--color-amber);
        }

        [data-theme="dark"] .topping-recommendation {
            background: #1a1917;
        }

        .topping-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-slate);
            margin-bottom: 0.25rem;
        }

        .topping-value {
            font-size: 0.9rem;
            color: var(--color-navy);
        }

        .no-results {
            text-align: center;
            padding: 3rem;
            color: var(--color-slate);
            font-size: 1.1rem;
        }

        .results-count {
            margin-bottom: 1rem;
            color: var(--color-slate);
            font-size: 0.95rem;
        }

        /* Footer */
        .section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: var(--color-cream);
            border: 1px solid var(--color-border);
        }

        [data-theme="dark"] .section {
            background: #1f1d1b;
        }

        .section h2 {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            color: var(--color-navy);
            margin-bottom: 0.5rem;
        }

        [data-theme="dark"] .section h2 {
            color: var(--color-cream);
        }

        .section h3 {
            font-family: var(--font-serif);
            font-size: 1.2rem;
            color: var(--color-navy);
        }

        [data-theme="dark"] .section h3 {
            color: var(--color-cream);
        }

        [data-theme="dark"] .section > div > div {
            background: #252320 !important;
        }

        .synergy-cookie-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            background: var(--color-cream);
            border: 1px solid var(--color-border);
        }

        [data-theme="dark"] .synergy-cookie-item {
            background: #1f1d1b;
            border-color: #3a3734;
        }

        .synergy-cookie-item .cookie-image-container {
            width: 50px;
            height: 50px;
            flex-shrink: 0;
            background: var(--color-cream);
            border: 2px solid var(--color-border);
        }

        [data-theme="dark"] .synergy-cookie-item .cookie-image-container {
            background: #252320;
            border-color: #3a3734;
        }

        .synergy-cookie-name {
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--color-navy);
            margin-bottom: 0.25rem;
        }

        .footer {
            text-align: center;
            margin-top: 4rem;
            padding: 2rem 0;
            color: var(--color-slate);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container { padding: 0.75rem; }
            h1 { font-size: 1.75rem; }
            header { padding-top: 3rem; margin-bottom: 1.5rem; }
            .subtitle { font-size: 0.95rem; }

            .cookie-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .filter-row {
                grid-template-columns: 1fr;
            }

            .filter-chip {
                padding: 0.65rem 1.1rem;
                min-height: 44px;
                font-size: 0.95rem;
            }

            .search-input {
                font-size: 16px; /* Prevents iOS zoom on focus */
                min-height: 44px;
            }

            .cookie-card {
                padding: 1rem;
            }

            .section {
                padding: 1rem;
                margin: 1rem 0;
            }

            .section h2 {
                font-size: 1.25rem;
            }

            .utility-buttons button {
                min-height: 44px;
                padding: 0.65rem 1rem;
            }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 2rem;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        [data-theme="dark"] .modal-content {
            background: #252320;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--color-slate);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: var(--color-navy);
        }

        .modal-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .modal-header .cookie-image-container {
            width: 80px;
            height: 80px;
        }

        .modal-title {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            color: var(--color-navy);
        }

        .modal-section {
            margin-bottom: 1.5rem;
        }

        .modal-section-title {
            font-weight: 600;
            color: var(--color-slate);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .modal-section-content {
            color: var(--color-navy);
            font-size: 1rem;
        }

        /* Team Builder Styles */
        .team-builder {
            background: white;
            padding: 1.5rem;
            margin: 2rem 0;
            border: 2px solid var(--color-border);
        }

        [data-theme="dark"] .team-builder {
            background: #252320;
        }

        .team-builder-title {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            color: var(--color-navy);
            margin-bottom: 1rem;
        }

        .team-slots {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .team-slots {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .team-slot {
            aspect-ratio: 1;
            border: 3px dashed var(--color-border);
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--color-cream);
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        [data-theme="dark"] .team-slot {
            background: #1a1917;
        }

        .team-slot:hover {
            border-color: var(--color-amber);
            transform: scale(1.05);
        }

        .team-slot.filled {
            border-style: solid;
            border-color: var(--color-success);
        }

        .team-slot-remove {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--color-warning);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .team-slot-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .team-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--color-border);
        }

        .team-stat {
            text-align: center;
        }

        .team-stat-label {
            font-size: 0.85rem;
            color: var(--color-slate);
            margin-bottom: 0.25rem;
        }

        .team-stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--color-amber);
        }

        .cookie-card.selectable {
            cursor: pointer;
            transition: all 0.2s;
        }

        .cookie-card.selectable:hover {
            border-color: var(--color-amber);
            transform: translateY(-2px);
        }

        .cookie-card.in-team {
            opacity: 0.6;
            border-color: var(--color-success);
        }

        @media print {
            .utility-buttons, .filters, .owned-checkbox, .team-builder {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="utility-buttons">
        <button class="utility-btn" id="exportBtn" aria-label="Export owned cookies" title="Export owned cookies">
            ðŸ’¾
        </button>
        <button class="utility-btn" id="shareBtn" aria-label="Share" title="Share">
            ðŸ”—
        </button>
        <button class="utility-btn" id="themeBtn" aria-label="Toggle dark mode" title="Toggle dark mode">
            ðŸŒ™
        </button>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Cookie data parsed from the guide
        const COOKIES_DATA = [
            // Common Cookies
            { name: "GingerBrave", rarity: "Common", type: "Charge", elements: [] },
            { name: "Strawberry Cookie", rarity: "Common", type: "Defense", elements: [] },
            { name: "Ninja Cookie", rarity: "Common", type: "Ambush", elements: [] },
            { name: "Angel Cookie", rarity: "Common", type: "Healing", elements: [] },
            { name: "Muscle Cookie", rarity: "Common", type: "Charge", elements: ["Steel"] },
            { name: "Wizard Cookie", rarity: "Common", type: "Magic", elements: ["Electricity"] },
            { name: "Beet Cookie", rarity: "Common", type: "Ranged", elements: [] },

            // Rare Cookies
            { name: "Adventurer Cookie", rarity: "Rare", type: "Ambush", elements: [] },
            { name: "Alchemist Cookie", rarity: "Rare", type: "Bomber", elements: ["Poison"] },
            { name: "Avocado Cookie", rarity: "Rare", type: "Defense", elements: [] },
            { name: "Blackberry Cookie", rarity: "Rare", type: "Magic", elements: [] },
            { name: "Carrot Cookie", rarity: "Rare", type: "Support", elements: [] },
            { name: "Cherry Cookie", rarity: "Rare", type: "Bomber", elements: [] },
            { name: "Clover Cookie", rarity: "Rare", type: "Support", elements: [] },
            { name: "Custard Cookie", rarity: "Rare", type: "Healing", elements: [] },
            { name: "Devil Cookie", rarity: "Rare", type: "Magic", elements: ["Darkness"] },
            { name: "Gumball Cookie", rarity: "Rare", type: "Bomber", elements: [] },
            { name: "Knight Cookie", rarity: "Rare", type: "Defense", elements: ["Steel"] },
            { name: "Onion Cookie", rarity: "Rare", type: "Support", elements: [] },
            { name: "Pancake Cookie", rarity: "Rare", type: "Ambush", elements: [] },
            { name: "Princess Cookie", rarity: "Rare", type: "Charge", elements: [] },

            // Epic Cookies
            { name: "Affogato Cookie", rarity: "Epic", type: "Bomber", elements: ["Poison"] },
            { name: "Agar Agar Cookie", rarity: "Epic", type: "Ambush", elements: ["Water", "Fire", "Ice", "Electricity", "Wind"] },
            { name: "Almond Cookie", rarity: "Epic", type: "Support", elements: ["Earth"] },
            { name: "Black Forest Cookie", rarity: "Epic", type: "Charge", elements: [] },
            { name: "Black Lemonade Cookie", rarity: "Epic", type: "Bomber", elements: ["Electricity"] },
            { name: "Black Raisin Cookie", rarity: "Epic", type: "Ambush", elements: ["Darkness"] },
            { name: "Black Sapphire Cookie", rarity: "Epic", type: "Support", elements: ["Poison"] },
            { name: "Blueberry Pie Cookie", rarity: "Epic", type: "Magic", elements: ["Electricity"] },
            { name: "Burnt Cheese Cookie", rarity: "Epic", type: "Charge", elements: ["Earth"] },
            { name: "Butter Roll Cookie", rarity: "Epic", type: "Charge", elements: ["Steel", "Chaos"] },
            { name: "Candy Apple Cookie", rarity: "Epic", type: "Bomber", elements: [] },
            { name: "Candy Diver Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Captain Caviar Cookie", rarity: "Epic", type: "Bomber", elements: ["Water"] },
            { name: "Caramel Arrow Cookie", rarity: "Epic", type: "Ranged", elements: ["Darkness"] },
            { name: "Caramel Choux Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Carol Cookie", rarity: "Epic", type: "Healing", elements: ["Grass"] },
            { name: "Charcoal Cookie", rarity: "Epic", type: "Magic", elements: ["Darkness"] },
            { name: "Cherry Blossom Cookie", rarity: "Epic", type: "Ambush", elements: ["Grass"] },
            { name: "Chess Choco Cookie", rarity: "Epic", type: "Bomber", elements: ["Chaos"] },
            { name: "Chili Pepper Cookie", rarity: "Epic", type: "Support", elements: ["Fire"] },
            { name: "Choco Drizzle Cookie", rarity: "Epic", type: "Ambush", elements: ["Darkness"] },
            { name: "Cloud Haetae Cookie", rarity: "Epic", type: "Defense", elements: [] },
            { name: "Cocoa Cookie", rarity: "Epic", type: "Defense", elements: [] },
            { name: "Cotton Cookie", rarity: "Epic", type: "Support", elements: ["Grass"] },
            { name: "Cream Puff Cookie", rarity: "Epic", type: "Magic", elements: ["Light"] },
            { name: "Cream Soda Cookie", rarity: "Epic", type: "Charge", elements: ["Water"] },
            { name: "Cream Unicorn Cookie", rarity: "Epic", type: "Healing", elements: ["Fire"] },
            { name: "CrÃ¨me BrÃ»lÃ©e Cookie", rarity: "Epic", type: "Ranged", elements: ["Light"] },
            { name: "Crunchy Chip Cookie", rarity: "Epic", type: "Charge", elements: ["Darkness"] },
            { name: "Dark Choco Cookie", rarity: "Epic", type: "Charge", elements: ["Darkness"] },
            { name: "Eclair Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Elphaba Cookie", rarity: "Epic", type: "Magic", elements: [] },
            { name: "Espresso Cookie", rarity: "Epic", type: "Magic", elements: ["Earth"] },
            { name: "Fettuccine Cookie", rarity: "Epic", type: "Defense", elements: ["Earth"] },
            { name: "Fig Cookie", rarity: "Epic", type: "Support", elements: ["Grass"] },
            { name: "Financier Cookie", rarity: "Epic", type: "Defense", elements: ["Light"] },
            { name: "Frilled Jellyfish Cookie", rarity: "Epic", type: "Support", elements: ["Water", "Electricity"] },
            { name: "Glinda Cookie", rarity: "Epic", type: "Magic", elements: [] },
            { name: "Golden Osmanthus Cookie", rarity: "Epic", type: "Bomber", elements: ["Grass"] },
            { name: "Grapefruit Cookie", rarity: "Epic", type: "Charge", elements: ["Electricity"] },
            { name: "Green Tea Mousse Cookie", rarity: "Epic", type: "Defense", elements: ["Wind", "Grass"] },
            { name: "Herb Cookie", rarity: "Epic", type: "Healing", elements: [] },
            { name: "Jagae Cookie", rarity: "Epic", type: "Support", elements: ["Water"] },
            { name: "Kouign-Amann Cookie", rarity: "Epic", type: "Defense", elements: [] },
            { name: "Kumiho Cookie", rarity: "Epic", type: "Charge", elements: ["Wind"] },
            { name: "Latte Cookie", rarity: "Epic", type: "Magic", elements: ["Earth"] },
            { name: "Lemon Cookie", rarity: "Epic", type: "Ambush", elements: ["Electricity"] },
            { name: "Lilac Cookie", rarity: "Epic", type: "Support", elements: ["Grass"] },
            { name: "Lime Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Linzer Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Licorice Cookie", rarity: "Epic", type: "Magic", elements: ["Darkness", "Poison", "Chaos"] },
            { name: "Macaron Cookie", rarity: "Epic", type: "Magic", elements: [] },
            { name: "Madeleine Cookie", rarity: "Epic", type: "Defense", elements: ["Light"] },
            { name: "Mala Sauce Cookie", rarity: "Epic", type: "Charge", elements: ["Fire"] },
            { name: "Mango Cookie", rarity: "Epic", type: "Magic", elements: ["Water"] },
            { name: "Manju Cookie", rarity: "Epic", type: "Ambush", elements: ["Water"] },
            { name: "Matcha Cookie", rarity: "Epic", type: "Magic", elements: ["Poison", "Grass"] },
            { name: "Menthol Cookie", rarity: "Epic", type: "Bomber", elements: ["Water"] },
            { name: "Mercurial Knight Cookie", rarity: "Epic", type: "Charge", elements: ["Steel"] },
            { name: "Milk Cookie", rarity: "Epic", type: "Defense", elements: [] },
            { name: "Milky Way Cookie", rarity: "Epic", type: "Charge", elements: [] },
            { name: "Mint Choco Cookie", rarity: "Epic", type: "Support", elements: ["Wind"] },
            { name: "Mold Dough Cookie", rarity: "Epic", type: "Charge", elements: ["Chaos"] },
            { name: "Moon Rabbit Cookie", rarity: "Epic", type: "Defense", elements: [] },
            { name: "Mozzarella Cookie", rarity: "Epic", type: "Magic", elements: ["Earth"] },
            { name: "Nutmeg Tiger Cookie", rarity: "Epic", type: "Support", elements: ["Fire"] },
            { name: "Okchun Cookie", rarity: "Epic", type: "Healing", elements: [] },
            { name: "Olive Cookie", rarity: "Epic", type: "Support", elements: ["Fire", "Earth", "Electricity"] },
            { name: "Orange Cookie", rarity: "Epic", type: "Magic", elements: ["Electricity"] },
            { name: "Parfait Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Pastry Cookie", rarity: "Epic", type: "Ranged", elements: ["Wind"] },
            { name: "Pavlova Cookie", rarity: "Epic", type: "Ranged", elements: [] },
            { name: "Peach Blossom Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Peppermint Cookie", rarity: "Epic", type: "Support", elements: ["Water"] },
            { name: "Pinecone Cookie", rarity: "Epic", type: "Bomber", elements: ["Ice"] },
            { name: "Poison Mushroom Cookie", rarity: "Epic", type: "Bomber", elements: ["Darkness", "Poison"] },
            { name: "Pomegranate Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Prophet Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Prune Juice Cookie", rarity: "Epic", type: "Bomber", elements: ["Grass", "Poison"] },
            { name: "Pudding Ã  la Mode Cookie", rarity: "Epic", type: "Bomber", elements: ["Electricity"] },
            { name: "Pumpkin Pie Cookie", rarity: "Epic", type: "Magic", elements: ["Darkness"] },
            { name: "Purple Yam Cookie", rarity: "Epic", type: "Charge", elements: ["Grass"] },
            { name: "Raspberry Cookie", rarity: "Epic", type: "Charge", elements: ["Steel"] },
            { name: "Rebel Cookie", rarity: "Epic", type: "Ambush", elements: ["Wind"] },
            { name: "Red Osmanthus Cookie", rarity: "Epic", type: "Ranged", elements: ["Grass"] },
            { name: "Red Velvet Cookie", rarity: "Epic", type: "Charge", elements: ["Darkness"] },
            { name: "Rockstar Cookie", rarity: "Epic", type: "Healing", elements: [] },
            { name: "Royal Margarine Cookie", rarity: "Epic", type: "Ambush", elements: ["Poison"] },
            { name: "Rye Cookie", rarity: "Epic", type: "Ranged", elements: ["Fire"] },
            { name: "Salt Cellar Cookie", rarity: "Epic", type: "Defense", elements: ["Steel"] },
            { name: "SchwarzwÃ¤lder", rarity: "Epic", type: "Charge", elements: ["Steel", "Chaos"] },
            { name: "Seltzer Cookie", rarity: "Epic", type: "Support", elements: ["Water"] },
            { name: "Silverbell Cookie", rarity: "Epic", type: "Support", elements: ["Grass"] },
            { name: "Smoked Cheese Cookie", rarity: "Epic", type: "Magic", elements: ["Earth"] },
            { name: "Snow Sugar Cookie", rarity: "Epic", type: "Magic", elements: ["Ice"] },
            { name: "Sorbet Shark Cookie", rarity: "Epic", type: "Ambush", elements: ["Water"] },
            { name: "Space Doughnut", rarity: "Epic", type: "Charge", elements: [] },
            { name: "Sparkling Cookie", rarity: "Epic", type: "Healing", elements: ["Light"] },
            { name: "Squid Ink Cookie", rarity: "Epic", type: "Magic", elements: ["Water"] },
            { name: "Star Coral Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Strawberry Crepe Cookie", rarity: "Epic", type: "Defense", elements: [] },
            { name: "Street Urchin Cookie", rarity: "Epic", type: "Bomber", elements: ["Fire"] },
            { name: "Sugarfly Cookie", rarity: "Epic", type: "Support", elements: [] },
            { name: "Tarte Tatin Cookie", rarity: "Epic", type: "Ranged", elements: ["Fire"] },
            { name: "Tea Knight Cookie", rarity: "Epic", type: "Charge", elements: ["Steel"] },
            { name: "Tiger Lily Cookie", rarity: "Epic", type: "Ranged", elements: [] },
            { name: "Twizzly Gummy Cookie", rarity: "Epic", type: "Ranged", elements: ["Electricity"] },
            { name: "Vampire Cookie", rarity: "Epic", type: "Ambush", elements: [] },
            { name: "Wedding Cake Cookie", rarity: "Epic", type: "Magic", elements: [] },
            { name: "Werewolf Cookie", rarity: "Epic", type: "Charge", elements: ["Steel"] },
            { name: "Wildberry Cookie", rarity: "Epic", type: "Defense", elements: ["Steel"] },

            // Super Epic Cookies
            { name: "Doughael", rarity: "Super Epic", type: "Healing", elements: [] },
            { name: "Camellia Cookie", rarity: "Super Epic", type: "Charge", elements: ["Grass"] },
            { name: "Elder Faerie Cookie", rarity: "Super Epic", type: "Defense", elements: ["Steel"] },
            { name: "Crimson Coral Cookie", rarity: "Super Epic", type: "Defense", elements: ["Water"] },
            { name: "Shining Glitter Cookie", rarity: "Super Epic", type: "Support", elements: ["Electricity"] },
            { name: "Capsaicin Cookie", rarity: "Super Epic", type: "Charge", elements: ["Fire"] },
            { name: "Stardust Cookie", rarity: "Super Epic", type: "Support", elements: [] },
            { name: "Sherbet Cookie", rarity: "Super Epic", type: "Support", elements: ["Ice"] },
            { name: "Oyster Cookie", rarity: "Super Epic", type: "Ranged", elements: [] },
            { name: "Clotted Cream Cookie", rarity: "Super Epic", type: "Support", elements: ["Light"] },

            // Dragon Cookies
            { name: "Pitaya Dragon Cookie", rarity: "Dragon", type: "Charge", elements: ["Fire"] },

            // Legendary Cookies
            { name: "Fire Spirit Cookie", rarity: "Legendary", type: "Magic", elements: ["Fire"] },
            { name: "Wind Archer Cookie", rarity: "Legendary", type: "Ranged", elements: ["Wind"] },
            { name: "Stormbringer Cookie", rarity: "Legendary", type: "Charge", elements: ["Electricity"] },
            { name: "Moonlight Cookie", rarity: "Legendary", type: "Support", elements: [] },
            { name: "Black Pearl Cookie", rarity: "Legendary", type: "Support", elements: ["Water"] },
            { name: "Frost Queen Cookie", rarity: "Legendary", type: "Support", elements: ["Ice"] },
            { name: "Sea Fairy Cookie", rarity: "Legendary", type: "Support", elements: ["Water"] },
            { name: "Millennial Tree Cookie", rarity: "Legendary", type: "Charge", elements: ["Grass"] },
            { name: "Dark Enchantress Cookie", rarity: "Legendary", type: "Magic", elements: ["Chaos"] },

            // Ancient Cookies
            { name: "Pure Vanilla Cookie", rarity: "Ancient", type: "Ranged", elements: ["Light"] },
            { name: "Hollyberry Cookie", rarity: "Ancient", type: "Defense", elements: ["Steel"] },
            { name: "Dark Cacao Cookie", rarity: "Ancient", type: "Charge", elements: ["Darkness"] },
            { name: "Golden Cheese Cookie", rarity: "Ancient", type: "Support", elements: ["Earth"] },
            { name: "White Lily Cookie", rarity: "Ancient", type: "Support", elements: ["Grass"] },

            // Awakened Ancient Cookies
            { name: "Dark Cacao Cookie (Dragon Lord)", rarity: "Awakened Ancient", type: "Charge", elements: ["Darkness", "Electricity"] },
            { name: "Golden Cheese Cookie (Immortal)", rarity: "Awakened Ancient", type: "Ranged", elements: ["Earth"] },
            { name: "Pure Vanilla Cookie (Compassionate)", rarity: "Awakened Ancient", type: "Healing", elements: ["Light"] },
            { name: "Hollyberry Cookie (Aegis)", rarity: "Awakened Ancient", type: "Defense", elements: ["Steel"] },
            { name: "White Lily Cookie (Dawnbringer)", rarity: "Awakened Ancient", type: "Bomber", elements: ["Grass"] },

            // Beast Cookies
            { name: "Mystic Flour Cookie", rarity: "Beast", type: "Ranged", elements: [] },
            { name: "Burning Spice Cookie", rarity: "Beast", type: "Charge", elements: ["Fire"] },
            { name: "Shadow Milk Cookie", rarity: "Beast", type: "Support", elements: [] },
            { name: "Eternal Sugar Cookie", rarity: "Beast", type: "Support", elements: ["Darkness"] },
            { name: "Silent Salt Cookie", rarity: "Beast", type: "Charge", elements: ["Darkness", "Steel"] },
        ];

        // Stat priorities by type
        const STAT_PRIORITIES = {
            "Ambush": { stats: "ATK > CRIT% > Cooldown > DMG Resist", toppings: "5x Searing Raspberry (ATK)" },
            "Bomber": { stats: "ATK > Cooldown > DMG Resist > ATK SPD", toppings: "5x Searing Raspberry or Swift Chocolate mix" },
            "Charge": { stats: "DMG Resist > HP > ATK > Cooldown", toppings: "5x Solid Almond (DMG Resist 40%+)" },
            "Defense": { stats: "DMG Resist > HP > Cooldown > DEF", toppings: "5x Solid Almond (DMG Resist 40%+)" },
            "Healing": { stats: "Cooldown > DMG Resist > ATK > HP", toppings: "5x Swift Chocolate (CD >20%)" },
            "Magic": { stats: "ATK > Cooldown > DMG Resist > CRIT%", toppings: "5x Searing Raspberry or Swift Chocolate" },
            "Ranged": { stats: "ATK > CRIT% > Cooldown > DMG Resist", toppings: "5x Searing Raspberry" },
            "Support": { stats: "Cooldown > DMG Resist > ATK > HP", toppings: "5x Swift Chocolate (CD >20%)" },
        };

        // Position mapping by type
        const TYPE_POSITIONS = {
            "Charge": "Front",
            "Defense": "Front",
            "Ambush": "Rear",
            "Bomber": "Rear",
            "Magic": "Rear",
            "Ranged": "Rear",
            "Support": "Middle",
            "Healing": "Middle"
        };

        // Cookie Image Component with fallback
        function CookieImage({ cookieName }) {
            const [imageError, setImageError] = useState(false);

            // Convert cookie name to filename format matching downloaded files
            const getImageFileName = (name) => {
                // Handle special cases first
                if (name === "GingerBrave") {
                    return "Gingerbrave_illustration.webp";
                }
                if (name === "Doughael") {
                    return "Doughael_illustration.webp";
                }
                if (name === "Space Doughnut") {
                    return "Space_doughnut_illustration.webp";
                }
                if (name === "Dark Enchantress Cookie") {
                    return "Dark_enchantress_illustration.webp";
                }
                if (name === "Millennial Tree Cookie") {
                    return "Millennial_illustration.webp";
                }
                if (name === "Kouign-Amann Cookie") {
                    return "Kouign_amann_illustration.webp";
                }
                if (name === "Pudding Ã  la Mode Cookie") {
                    return "Pudding_a_la_mode_illustration.webp";
                }
                if (name === "SchwarzwÃ¤lder") {
                    return "Schwarzwalder_illustration.webp";
                }
                if (name === "CrÃ¨me BrÃ»lÃ©e Cookie") {
                    return "Creme_brulee_illustration.webp";
                }

                // Handle Awakened Ancient cookies
                if (name.includes("(Dragon Lord)")) {
                    return "Awakened_dark_cacao_illustration.webp";
                }
                if (name.includes("(Immortal)")) {
                    return "Awakened_golden_cheese_illustration.webp";
                }
                if (name.includes("(Compassionate)")) {
                    return "Awakened_pure_vanilla_illustration.webp";
                }
                if (name.includes("(Aegis)")) {
                    return "Awakened_hollyberry_illustration.webp";
                }
                if (name.includes("(Dawnbringer)")) {
                    return "Awakened_white_lily_illustration.webp";
                }

                // Standard format: First_word_second_word_illustration.webp
                // Remove " Cookie" from the end and convert
                let baseName = name.replace(" Cookie", "");
                // Replace spaces with underscores - only capitalize first word
                baseName = baseName.split(' ')
                    .map((word, index) => index === 0
                        ? word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
                        : word.toLowerCase())
                    .join('_');

                return `${baseName}_illustration.webp`;
            };

            const imageFileName = getImageFileName(cookieName);
            const imagePath = `images/${imageFileName}`;

            // Get initials for placeholder
            const getInitials = (name) => {
                const words = name.split(' ');
                if (words.length === 1) return name.substring(0, 2).toUpperCase();
                return words.slice(0, 2).map(w => w[0]).join('').toUpperCase();
            };

            if (imageError) {
                return (
                    <div className="cookie-image-placeholder">
                        {getInitials(cookieName)}
                    </div>
                );
            }

            return (
                <img
                    src={imagePath}
                    alt={cookieName}
                    className="cookie-image"
                    onError={() => setImageError(true)}
                />
            );
        }

        // Cookie Type/Position Icons Component
        function CookieIcons({ cookieType }) {
            const [typeIconError, setTypeIconError] = useState(false);

            return (
                <div className="cookie-icons">
                    {!typeIconError && (
                        <img
                            src={`images/${cookieType}.webp`}
                            alt={cookieType}
                            className="type-icon"
                            title={cookieType}
                            onError={() => setTypeIconError(true)}
                        />
                    )}
                </div>
            );
        }

        function App() {
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedType, setSelectedType] = useState('All');
            const [selectedElement, setSelectedElement] = useState('All');
            const [selectedRarity, setSelectedRarity] = useState('All');
            const [showOwnedOnly, setShowOwnedOnly] = useState(false);
            const [sortBy, setSortBy] = useState('name');
            const [showElementChart, setShowElementChart] = useState(false);
            const [showSynergies, setShowSynergies] = useState(false);
            const [showTeamBuilder, setShowTeamBuilder] = useState(false);
            const [selectedCookie, setSelectedCookie] = useState(null);
            const [team, setTeam] = useState([]);
            const [ownedCookies, setOwnedCookies] = useState(() => {
                const saved = localStorage.getItem('ownedCookies');
                return saved ? JSON.parse(saved) : {};
            });

            // Save owned cookies to localStorage
            useEffect(() => {
                localStorage.setItem('ownedCookies', JSON.stringify(ownedCookies));
            }, [ownedCookies]);

            // Get unique values for filters
            const types = ['All', ...new Set(COOKIES_DATA.map(c => c.type))].sort();
            const elements = ['All', 'None', ...new Set(COOKIES_DATA.flatMap(c => c.elements))].sort();
            const rarities = ['All', ...new Set(COOKIES_DATA.map(c => c.rarity))];

            // Filter and sort cookies
            const filteredCookies = useMemo(() => {
                const filtered = COOKIES_DATA.filter(cookie => {
                    const matchesSearch = cookie.name.toLowerCase().includes(searchTerm.toLowerCase());
                    const matchesType = selectedType === 'All' || cookie.type === selectedType;
                    const matchesElement = selectedElement === 'All' ||
                        (selectedElement === 'None' && cookie.elements.length === 0) ||
                        cookie.elements.includes(selectedElement);
                    const matchesRarity = selectedRarity === 'All' || cookie.rarity === selectedRarity;
                    const matchesOwned = !showOwnedOnly || ownedCookies[cookie.name];

                    return matchesSearch && matchesType && matchesElement && matchesRarity && matchesOwned;
                });

                // Sort filtered results
                const rarityOrder = { 'Beast': 0, 'Awakened Ancient': 1, 'Ancient': 2, 'Legendary': 3, 'Dragon': 4, 'Super Epic': 5, 'Epic': 6, 'Rare': 7, 'Common': 8 };
                return filtered.sort((a, b) => {
                    if (sortBy === 'name') {
                        return a.name.localeCompare(b.name);
                    } else if (sortBy === 'rarity') {
                        return rarityOrder[a.rarity] - rarityOrder[b.rarity];
                    } else if (sortBy === 'type') {
                        return a.type.localeCompare(b.type);
                    }
                    return 0;
                });
            }, [searchTerm, selectedType, selectedElement, selectedRarity, showOwnedOnly, ownedCookies, sortBy]);

            const toggleOwned = (cookieName, e) => {
                e.stopPropagation();
                setOwnedCookies(prev => ({
                    ...prev,
                    [cookieName]: !prev[cookieName]
                }));
            };

            const clearFilters = () => {
                setSearchTerm('');
                setSelectedType('All');
                setSelectedElement('All');
                setSelectedRarity('All');
                setShowOwnedOnly(false);
            };

            // Team builder functions
            const addToTeam = (cookie) => {
                if (team.length < 5 && !team.find(c => c.name === cookie.name)) {
                    setTeam([...team, cookie]);
                }
            };

            const removeFromTeam = (cookieName) => {
                setTeam(team.filter(c => c.name !== cookieName));
            };

            const clearTeam = () => {
                setTeam([]);
            };

            // Cookie modal functions
            const openCookieModal = (cookie, e) => {
                if (e) e.stopPropagation();
                setSelectedCookie(cookie);
            };

            const closeCookieModal = () => {
                setSelectedCookie(null);
            };

            // Team statistics
            const teamStats = useMemo(() => {
                const types = {};
                const elements = {};
                team.forEach(cookie => {
                    types[cookie.type] = (types[cookie.type] || 0) + 1;
                    cookie.elements.forEach(el => {
                        elements[el] = (elements[el] || 0) + 1;
                    });
                });
                return { types, elements };
            }, [team]);

            // Calculate element distribution
            const elementDistribution = useMemo(() => {
                const dist = {};
                COOKIES_DATA.forEach(cookie => {
                    if (cookie.elements.length === 0) {
                        dist['None'] = (dist['None'] || 0) + 1;
                    } else {
                        cookie.elements.forEach(element => {
                            dist[element] = (dist[element] || 0) + 1;
                        });
                    }
                });
                return Object.entries(dist).sort((a, b) => b[1] - a[1]);
            }, []);

            // Beascuit type mapping by cookie class
            const BEASCUIT_TYPES = {
                'Ambush': 'Crispy Beascuit',
                'Bomber': 'Spicy Beascuit',
                'Charge': 'Chewy Beascuit',
                'Defense': 'Hard Beascuit',
                'Healing': 'Sweet Beascuit',
                'Magic': 'Zesty Beascuit',
                'Ranged': 'Light Beascuit',
                'Support': 'Hearty Beascuit'
            };

            // Elemental prefix mapping
            const ELEMENT_PREFIXES = {
                'Fire': 'Burning',
                'Water': 'Watery',
                'Grass': 'Grassy',
                'Earth': 'Earthy',
                'Wind': 'Windy',
                'Ice': 'Frozen',
                'Electricity': 'Thunderous',
                'Light': 'Radiant',
                'Darkness': 'Dark',
                'Poison': 'Poisonous',
                'Steel': 'Steely',
                'Chaos': 'Tainted'
            };

            // Get beascuit recommendation for a cookie
            const getBeascuitRecommendation = (cookieType, elements) => {
                const baseBeascuit = BEASCUIT_TYPES[cookieType];
                if (elements.length === 0) {
                    return baseBeascuit;
                }
                // Recommend elemental variant for primary element
                const primaryElement = elements[0];
                const prefix = ELEMENT_PREFIXES[primaryElement];
                return `${prefix} ${baseBeascuit}`;
            };

            // Team synergy recommendations
            const SYNERGY_TEAMS = [
                {
                    name: 'Water Domination',
                    cookies: ['Sea Fairy Cookie', 'Black Pearl Cookie', 'Captain Caviar Cookie', 'Frilled Jellyfish Cookie', 'Sorbet Shark Cookie'],
                    description: 'High water synergy with massive burst damage'
                },
                {
                    name: 'Fire Power',
                    cookies: ['Fire Spirit Cookie', 'Burning Spice Cookie', 'Capsaicin Cookie', 'Pitaya Dragon Cookie', 'Rye Cookie'],
                    description: 'Massive fire damage output with strong frontline'
                },
                {
                    name: 'Earth Fortress',
                    cookies: ['Golden Cheese Cookie', 'Burnt Cheese Cookie', 'Smoked Cheese Cookie', 'Espresso Cookie', 'Mozzarella Cookie'],
                    description: 'Excellent for Cookie Alliance with strong earth synergy'
                },
                {
                    name: 'Electric Storm',
                    cookies: ['Stormbringer Cookie', 'Dark Cacao Cookie', 'Twizzly Gummy Cookie', 'Blueberry Pie Cookie', 'Shining Glitter Cookie'],
                    description: 'Lightning fast attacks with high electricity damage'
                },
                {
                    name: 'Beast Mode',
                    cookies: ['Burning Spice Cookie', 'Shadow Milk Cookie', 'Mystic Flour Cookie', 'Eternal Sugar Cookie', 'Silent Salt Cookie'],
                    description: 'Ultimate endgame team with Beast cookies'
                },
                {
                    name: 'Ancients United',
                    cookies: ['Pure Vanilla Cookie', 'Hollyberry Cookie', 'Dark Cacao Cookie', 'Golden Cheese Cookie', 'White Lily Cookie'],
                    description: 'Balanced Ancient team for most content'
                }
            ];

            return (
                <div className="container">
                    <header>
                        <h1>Cookie Run Kingdom Reference</h1>
                        <p className="subtitle">Quick reference for cookie elements, stats, and topping builds</p>
                    </header>

                    <div className="filters">
                        <div className="filter-group">
                            <label className="filter-label">Search Cookies</label>
                            <input
                                type="text"
                                className="search-input"
                                placeholder="Search by name..."
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                            />
                        </div>

                        <div className="filter-row">
                            <div className="filter-group">
                                <label className="filter-label">Cookie Type</label>
                                <div className="filter-chips">
                                    {types.map(type => (
                                        <button
                                            key={type}
                                            className={`filter-chip ${selectedType === type ? 'active' : ''}`}
                                            onClick={() => setSelectedType(type)}
                                        >
                                            {type}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="filter-group">
                                <label className="filter-label">Element</label>
                                <div className="filter-chips">
                                    {elements.map(element => (
                                        <button
                                            key={element}
                                            className={`filter-chip ${selectedElement === element ? 'active' : ''}`}
                                            onClick={() => setSelectedElement(element)}
                                        >
                                            {element}
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>

                        <div className="filter-row">
                            <div className="filter-group">
                                <label className="filter-label">Rarity</label>
                                <div className="filter-chips">
                                    {rarities.map(rarity => (
                                        <button
                                            key={rarity}
                                            className={`filter-chip ${selectedRarity === rarity ? 'active' : ''}`}
                                            onClick={() => setSelectedRarity(rarity)}
                                        >
                                            {rarity}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="filter-group">
                                <label className="filter-label">View</label>
                                <div className="filter-chips">
                                    <button
                                        className={`filter-chip ${!showOwnedOnly ? 'active' : ''}`}
                                        onClick={() => setShowOwnedOnly(false)}
                                    >
                                        All Cookies
                                    </button>
                                    <button
                                        className={`filter-chip ${showOwnedOnly ? 'active' : ''}`}
                                        onClick={() => setShowOwnedOnly(true)}
                                    >
                                        Owned Only
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="filter-row">
                            <div className="filter-group">
                                <label className="filter-label">Sort By</label>
                                <div className="filter-chips">
                                    <button
                                        className={`filter-chip ${sortBy === 'name' ? 'active' : ''}`}
                                        onClick={() => setSortBy('name')}
                                    >
                                        Name
                                    </button>
                                    <button
                                        className={`filter-chip ${sortBy === 'rarity' ? 'active' : ''}`}
                                        onClick={() => setSortBy('rarity')}
                                    >
                                        Rarity
                                    </button>
                                    <button
                                        className={`filter-chip ${sortBy === 'type' ? 'active' : ''}`}
                                        onClick={() => setSortBy('type')}
                                    >
                                        Type
                                    </button>
                                </div>
                            </div>

                            <div className="filter-group">
                                <label className="filter-label">Actions</label>
                                <div className="filter-chips">
                                    <button className="filter-chip" onClick={clearFilters}>
                                        Clear Filters
                                    </button>
                                    <button
                                        className="filter-chip"
                                        onClick={() => setShowElementChart(!showElementChart)}
                                    >
                                        {showElementChart ? 'Hide' : 'Show'} Element Chart
                                    </button>
                                    <button
                                        className="filter-chip"
                                        onClick={() => setShowSynergies(!showSynergies)}
                                    >
                                        {showSynergies ? 'Hide' : 'Show'} Team Synergies
                                    </button>
                                    <button
                                        className="filter-chip"
                                        onClick={() => setShowTeamBuilder(!showTeamBuilder)}
                                    >
                                        {showTeamBuilder ? 'Hide' : 'Show'} Team Builder
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {showTeamBuilder && (
                        <div className="team-builder">
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
                                <h2 className="team-builder-title">Team Builder</h2>
                                {team.length > 0 && (
                                    <button className="filter-chip" onClick={clearTeam}>Clear Team</button>
                                )}
                            </div>
                            <p style={{ color: 'var(--color-slate)', marginBottom: '1rem', fontSize: '0.95rem' }}>
                                Click cookies below to add them to your team (max 5)
                            </p>
                            <div className="team-slots">
                                {[0, 1, 2, 3, 4].map(index => (
                                    <div key={index} className={`team-slot ${team[index] ? 'filled' : ''}`}>
                                        {team[index] ? (
                                            <>
                                                <CookieImage cookieName={team[index].name} />
                                                <button
                                                    className="team-slot-remove"
                                                    onClick={() => removeFromTeam(team[index].name)}
                                                    title="Remove from team"
                                                >
                                                    Ã—
                                                </button>
                                            </>
                                        ) : (
                                            <span style={{ fontSize: '2rem', color: 'var(--color-slate)' }}>+</span>
                                        )}
                                    </div>
                                ))}
                            </div>
                            {team.length > 0 && (
                                <div className="team-stats">
                                    <div className="team-stat">
                                        <div className="team-stat-label">Team Size</div>
                                        <div className="team-stat-value">{team.length}/5</div>
                                    </div>
                                    <div className="team-stat">
                                        <div className="team-stat-label">Elements</div>
                                        <div className="team-stat-value">{Object.keys(teamStats.elements).length || 0}</div>
                                    </div>
                                    <div className="team-stat">
                                        <div className="team-stat-label">Types</div>
                                        <div className="team-stat-value">
                                            {Object.entries(teamStats.types).map(([type, count]) => (
                                                <div key={type} style={{ fontSize: '0.75rem', fontWeight: '400', color: 'var(--color-slate)' }}>
                                                    {type}: {count}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}

                    {showElementChart && (
                        <div className="section">
                            <h2>Element Distribution</h2>
                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '1rem', marginTop: '1rem' }}>
                                {elementDistribution.map(([element, count]) => (
                                    <div key={element} style={{ background: 'white', padding: '1rem', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.05)' }}>
                                        <div style={{ fontWeight: '600', color: 'var(--color-navy)', marginBottom: '0.5rem' }}>{element}</div>
                                        <div style={{ fontSize: '2rem', fontWeight: '700', color: 'var(--color-amber)' }}>{count}</div>
                                        <div style={{ fontSize: '0.875rem', color: 'var(--color-slate)' }}>
                                            {((count / COOKIES_DATA.length) * 100).toFixed(1)}%
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {showSynergies && (
                        <div className="section">
                            <h2>Recommended Team Synergies</h2>
                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))', gap: '1rem', marginTop: '1rem' }}>
                                {SYNERGY_TEAMS.map(team => (
                                    <div key={team.name} style={{ background: 'white', padding: '1.5rem', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.05)' }}>
                                        <h3 style={{ color: 'var(--color-navy)', marginBottom: '0.5rem' }}>{team.name}</h3>
                                        <p style={{ fontSize: '0.875rem', color: 'var(--color-slate)', marginBottom: '1rem' }}>{team.description}</p>
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                                            {team.cookies.map((cookieName, i) => {
                                                const cookieData = COOKIES_DATA.find(c => c.name === cookieName);
                                                return (
                                                    <div key={i} className="synergy-cookie-item">
                                                        <div className="cookie-image-container">
                                                            <CookieImage cookieName={cookieName} />
                                                        </div>
                                                        <div style={{ flex: 1, minWidth: 0 }}>
                                                            <div className="synergy-cookie-name">
                                                                {cookieName}
                                                            </div>
                                                            {cookieData && (
                                                                <div style={{ display: 'flex', gap: '0.25rem', alignItems: 'center' }}>
                                                                    <CookieIcons cookieType={cookieData.type} />
                                                                </div>
                                                            )}
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    <div className="results-count">
                        Showing {filteredCookies.length} of {COOKIES_DATA.length} cookies
                    </div>

                    {filteredCookies.length === 0 ? (
                        <div className="no-results">
                            No cookies found matching your filters.
                        </div>
                    ) : (
                        <div className="cookie-grid">
                            {filteredCookies.map(cookie => {
                                const statInfo = STAT_PRIORITIES[cookie.type];
                                const inTeam = team.find(c => c.name === cookie.name);
                                return (
                                    <div
                                        key={cookie.name}
                                        className={`cookie-card ${ownedCookies[cookie.name] ? 'owned' : ''} ${showTeamBuilder ? 'selectable' : ''} ${inTeam ? 'in-team' : ''}`}
                                        onClick={showTeamBuilder ? (e) => {
                                            e.stopPropagation();
                                            if (inTeam) {
                                                removeFromTeam(cookie.name);
                                            } else {
                                                addToTeam(cookie);
                                            }
                                        } : (e) => openCookieModal(cookie, e)}
                                    >
                                        <div className="cookie-header">
                                            <div className="cookie-image-container">
                                                <CookieImage cookieName={cookie.name} />
                                            </div>
                                            <div className="cookie-info">
                                                <div className="cookie-name">{cookie.name}</div>
                                                <div className="cookie-rarity-row">
                                                    <div className="cookie-rarity">{cookie.rarity}</div>
                                                    <CookieIcons cookieType={cookie.type} />
                                                </div>
                                            </div>
                                            <input
                                                type="checkbox"
                                                className="owned-checkbox"
                                                checked={!!ownedCookies[cookie.name]}
                                                onChange={(e) => toggleOwned(cookie.name, e)}
                                                title="Mark as owned"
                                            />
                                        </div>

                                        <div className="cookie-meta">
                                            <div className="badge-group">
                                                <span className="badge-group-label">Type:</span>
                                                <span className="meta-badge type-position-badge">{cookie.type}</span>
                                                <span className="meta-badge type-position-badge">{TYPE_POSITIONS[cookie.type]}</span>
                                            </div>
                                            <div className="badge-group">
                                                <span className="badge-group-label">Elements:</span>
                                                {cookie.elements.length === 0 ? (
                                                    <span className="meta-badge element-badge">None</span>
                                                ) : (
                                                    cookie.elements.map(element => (
                                                        <span key={element} className="meta-badge element-badge">{element}</span>
                                                    ))
                                                )}
                                            </div>
                                        </div>

                                        <div className="cookie-stats">
                                            <div className="stats-label">Stat Priority</div>
                                            <div className="stats-value">{statInfo.stats}</div>
                                        </div>

                                        <div className="topping-recommendation">
                                            <div className="topping-label">Topping Build</div>
                                            <div className="topping-value">{statInfo.toppings}</div>
                                        </div>

                                        <div className="topping-recommendation">
                                            <div className="topping-label">Recommended Beascuit</div>
                                            <div className="topping-value">
                                                {getBeascuitRecommendation(cookie.type, cookie.elements)}
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    )}

                    <div className="footer">
                        <p>Cookie Run Kingdom Reference Guide â€¢ Data updated January 29, 2026</p>
                    </div>

                    {selectedCookie && (
                        <div className="modal-overlay" onClick={closeCookieModal}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <button className="modal-close" onClick={closeCookieModal}>Ã—</button>

                                <div className="modal-header">
                                    <div className="cookie-image-container">
                                        <CookieImage cookieName={selectedCookie.name} />
                                    </div>
                                    <div>
                                        <h2 className="modal-title">{selectedCookie.name}</h2>
                                        <div style={{ display: 'flex', gap: '0.5rem', marginTop: '0.5rem' }}>
                                            <span className="meta-badge type-position-badge">{selectedCookie.rarity}</span>
                                            <span className="meta-badge type-position-badge">{selectedCookie.type}</span>
                                            <span className="meta-badge type-position-badge">{TYPE_POSITIONS[selectedCookie.type]}</span>
                                        </div>
                                    </div>
                                </div>

                                <div className="modal-section">
                                    <div className="modal-section-title">Elements</div>
                                    <div className="modal-section-content">
                                        {selectedCookie.elements.length === 0 ? (
                                            <span className="meta-badge element-badge">None</span>
                                        ) : (
                                            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
                                                {selectedCookie.elements.map(element => (
                                                    <span key={element} className="meta-badge element-badge">{element}</span>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                </div>

                                <div className="modal-section">
                                    <div className="modal-section-title">Stat Priority</div>
                                    <div className="modal-section-content">
                                        {STAT_PRIORITIES[selectedCookie.type]?.stats}
                                    </div>
                                </div>

                                <div className="modal-section">
                                    <div className="modal-section-title">Recommended Toppings</div>
                                    <div className="modal-section-content">
                                        {STAT_PRIORITIES[selectedCookie.type]?.toppings}
                                    </div>
                                </div>

                                <div className="modal-section">
                                    <div className="modal-section-title">Recommended Beascuit</div>
                                    <div className="modal-section-content">
                                        {getBeascuitRecommendation(selectedCookie.type, selectedCookie.elements)}
                                    </div>
                                </div>

                                <div style={{ display: 'flex', gap: '1rem', marginTop: '1.5rem' }}>
                                    <button
                                        className="filter-chip"
                                        style={{ flex: 1 }}
                                        onClick={(e) => {
                                            e.stopPropagation();
                                            toggleOwned(selectedCookie.name, e);
                                        }}
                                    >
                                        {ownedCookies[selectedCookie.name] ? 'âœ“ Owned' : 'Mark as Owned'}
                                    </button>
                                    {team.length < 5 && !team.find(c => c.name === selectedCookie.name) && (
                                        <button
                                            className="filter-chip"
                                            style={{ flex: 1, background: 'var(--color-success)', borderColor: 'var(--color-success)', color: 'white' }}
                                            onClick={() => {
                                                addToTeam(selectedCookie);
                                                closeCookieModal();
                                            }}
                                        >
                                            Add to Team
                                        </button>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));

        // Theme toggle functionality
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        const themeBtn = document.getElementById('themeBtn');
        themeBtn.textContent = savedTheme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';

        themeBtn.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            themeBtn.textContent = newTheme === 'dark' ? 'â˜€ï¸' : 'ðŸŒ™';
        });

        // Share button functionality
        // Export button functionality
        document.getElementById('exportBtn').addEventListener('click', () => {
            const ownedCookies = JSON.parse(localStorage.getItem('ownedCookies') || '{}');
            const ownedList = COOKIES_DATA.filter(cookie => ownedCookies[cookie.name]);

            if (ownedList.length === 0) {
                alert('No owned cookies to export. Mark cookies as owned by checking the boxes.');
                return;
            }

            // Create CSV content
            const headers = ['Cookie Name', 'Rarity', 'Type', 'Position', 'Elements', 'Stat Priority', 'Topping Build'];
            const rows = ownedList.map(cookie => {
                const statInfo = STAT_PRIORITIES[cookie.type];
                const position = TYPE_POSITIONS[cookie.type];
                const elements = cookie.elements.length > 0 ? cookie.elements.join(' / ') : 'None';
                return [
                    cookie.name,
                    cookie.rarity,
                    cookie.type,
                    position,
                    elements,
                    statInfo.stats,
                    statInfo.toppings
                ];
            });

            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
            ].join('\n');

            // Download CSV file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `crk_owned_cookies_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });

        // Share button functionality
        document.getElementById('shareBtn').addEventListener('click', async () => {
            const url = window.location.href;
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'Cookie Run Kingdom Reference Guide',
                        text: 'Check out this Cookie Run Kingdom reference for elements, stats, and builds',
                        url: url
                    });
                } catch (err) {
                    if (err.name !== 'AbortError') {
                        try {
                            await navigator.clipboard.writeText(url);
                            alert('Link copied to clipboard!');
                        } catch (e) {
                            console.error('Copy failed:', e);
                        }
                    }
                }
            } else {
                try {
                    await navigator.clipboard.writeText(url);
                    alert('Link copied to clipboard!');
                } catch (err) {
                    console.error('Copy failed:', err);
                }
            }
        });
    </script>
</body>
</html>
